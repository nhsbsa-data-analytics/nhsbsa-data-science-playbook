<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-GB" xml:lang="en-GB"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Analysis loop - prepare data, analyse it and review until outputs in problem definition are finalised.">

<title>NHSBSA DALL Playbook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../static/bsa-favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-listing/list.min.js"></script>
<script src="../../site_libs/quarto-listing/quarto-listing.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script>

  window.document.addEventListener("DOMContentLoaded", function (_event) {
    const listingTargetEl = window.document.querySelector('#listing-listing .list');
    if (!listingTargetEl) {
      // No listing discovered, do not attach.
      return; 
    }

    const options = {
      valueNames: ['listing-title','listing-author','listing-image','listing-description',{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
      
      searchColumns: ["listing-title","listing-author","listing-image","listing-description"],
    };

    window['quarto-listings'] = window['quarto-listings'] || {};
    window['quarto-listings']['listing-listing'] = new List('listing-listing', options);

    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  });

  window.addEventListener('hashchange',() => {
    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  })
  </script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../static/logo-nhs.svg" alt="NHS logo" class="navbar-logo">
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-guidance" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Guidance</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-guidance">    
        <li>
    <a class="dropdown-item" href="../../guidance/pre-pd/index.qmd">
 <span class="dropdown-text"></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../guidance/pd/index.qmd">
 <span class="dropdown-text"></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../guidance/analysis/index.html">
 <span class="dropdown-text">Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../guidance/wrap-up/index.qmd">
 <span class="dropdown-text"></span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.nhsbsa.nhs.uk/nhsbsa-statistics-and-data-science"><i class="bi bi-globe" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/nhsbsa-data-analytics"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/nhsbsa"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <h1 class="title">Analysis</h1>
                  <div>
        <div class="description">
          Analysis loop - prepare data, analyse it and review until outputs in problem definition are finalised.
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link active" data-scroll-target="#data-preparation">Data preparation</a></li>
  <li><a href="#analysis-and-modelling" id="toc-analysis-and-modelling" class="nav-link" data-scroll-target="#analysis-and-modelling">Analysis and modelling</a></li>
  <li><a href="#output-artifacts" id="toc-output-artifacts" class="nav-link" data-scroll-target="#output-artifacts">Output artifacts</a></li>
  <li><a href="#team-review" id="toc-team-review" class="nav-link" data-scroll-target="#team-review">Team review</a></li>
  <li><a href="#critical-friend-review" id="toc-critical-friend-review" class="nav-link" data-scroll-target="#critical-friend-review">Critical friend review</a></li>
  <li><a href="#customer-review" id="toc-customer-review" class="nav-link" data-scroll-target="#customer-review">Customer review</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content">




<p><img src="analysis.jpg" class="img-fluid" alt="Photo by Emily Morter on Unsplash"></p>
<div class="cell">
<div class="cell-output-display">
<div>
<p>
<svg width="672" height="480" viewbox="0.00 0.00 272.89 401.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 397)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-397 268.89,-397 268.89,4 -4,4"></polygon> <g id="clust1" class="cluster">
<title>
cluster_analysis_loop
</title>
<defs> <lineargradient id="l_0" gradientunits="userSpaceOnUse" x1="35.35" y1="-196.5" x2="256.89" y2="-196.5"> <stop offset="0" style="stop-color:darkgray;stop-opacity:1.;"></stop> <stop offset="1" style="stop-color:gold;stop-opacity:1.;"></stop> </lineargradient> </defs> <polygon fill="url(#l_0)" stroke="lightgrey" points="35.35,-8 35.35,-385 256.89,-385 256.89,-8 35.35,-8"></polygon> <text text-anchor="middle" x="146.12" y="-368.4" font-family="Helvetica,Arial,sans-serif" font-size="14.00">03: Analysis and modelling</text> </g> <g id="clust2" class="cluster">
<title>
cluster_dummy_c
</title>
</g> <!-- 20 --> <!-- c1 --> <g id="node2" class="node">
<title>
c1
</title>
<defs> <lineargradient id="l_1" gradientunits="userSpaceOnUse" x1="146.12" y1="-322" x2="146.12" y2="-286"> <stop offset="0" style="stop-color:yellow;stop-opacity:1.;"></stop> <stop offset="1" style="stop-color:green;stop-opacity:1.;"></stop> </lineargradient> </defs> <ellipse fill="url(#l_1)" stroke="transparent" stroke-width="0" cx="146.12" cy="-304" rx="75.8" ry="18"></ellipse> <text text-anchor="middle" x="146.12" y="-299.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">Data preparation</text> </g> <!-- c2 --> <g id="node3" class="node">
<title>
c2
</title>
<defs> <lineargradient id="l_2" gradientunits="userSpaceOnUse" x1="146.12" y1="-268" x2="146.12" y2="-232"> <stop offset="0" style="stop-color:lightgreen;stop-opacity:1.;"></stop> <stop offset="1" style="stop-color:red;stop-opacity:1.;"></stop> </lineargradient> </defs> <ellipse fill="url(#l_2)" stroke="transparent" stroke-width="0" cx="146.12" cy="-250" rx="102.54" ry="18"></ellipse> <text text-anchor="middle" x="146.12" y="-245.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">Analysis and modelling</text> </g> <!-- c1&#45;&gt;c2 --> <g id="edge1" class="edge">
<title>
c1-&gt;c2
</title>
<path fill="none" stroke="black" d="M146.12,-285.79C146.12,-283.31 146.12,-280.83 146.12,-278.34"></path> <polygon fill="black" stroke="black" points="149.62,-278.14 146.12,-268.14 142.62,-278.14 149.62,-278.14"></polygon> </g> <!-- c3 --> <g id="node4" class="node">
<title>
c3
</title>
<defs> <lineargradient id="l_3" gradientunits="userSpaceOnUse" x1="146.12" y1="-214" x2="146.12" y2="-178"> <stop offset="0" style="stop-color:lightskyblue;stop-opacity:1.;"></stop> <stop offset="1" style="stop-color:darkcyan;stop-opacity:1.;"></stop> </lineargradient> </defs> <ellipse fill="url(#l_3)" stroke="transparent" stroke-width="0" cx="146.12" cy="-196" rx="71.25" ry="18"></ellipse> <text text-anchor="middle" x="146.12" y="-191.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">Output artifacts</text> </g> <!-- c2&#45;&gt;c3 --> <g id="edge2" class="edge">
<title>
c2-&gt;c3
</title>
<path fill="none" stroke="black" d="M146.12,-231.79C146.12,-229.31 146.12,-226.83 146.12,-224.34"></path> <polygon fill="black" stroke="black" points="149.62,-224.14 146.12,-214.14 142.62,-224.14 149.62,-224.14"></polygon> </g> <!-- c4 --> <g id="node5" class="node">
<title>
c4
</title>
<defs> <lineargradient id="l_4" gradientunits="userSpaceOnUse" x1="146.12" y1="-160" x2="146.12" y2="-124"> <stop offset="0" style="stop-color:cyan;stop-opacity:1.;"></stop> <stop offset="1" style="stop-color:#8470ff;stop-opacity:1.;"></stop> </lineargradient> </defs> <ellipse fill="url(#l_4)" stroke="transparent" stroke-width="0" cx="146.12" cy="-142" rx="61.92" ry="18"></ellipse> <text text-anchor="middle" x="146.12" y="-137.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">Team review</text> </g> <!-- c3&#45;&gt;c4 --> <g id="edge3" class="edge">
<title>
c3-&gt;c4
</title>
<path fill="none" stroke="black" d="M146.12,-177.79C146.12,-175.31 146.12,-172.83 146.12,-170.34"></path> <polygon fill="black" stroke="black" points="149.62,-170.14 146.12,-160.14 142.62,-170.14 149.62,-170.14"></polygon> </g> <!-- c5 --> <g id="node6" class="node">
<title>
c5
</title>
<defs> <lineargradient id="l_5" gradientunits="userSpaceOnUse" x1="146.12" y1="-106" x2="146.12" y2="-70"> <stop offset="0" style="stop-color:skyblue;stop-opacity:1.;"></stop> <stop offset="1" style="stop-color:green;stop-opacity:1.;"></stop> </lineargradient> </defs> <ellipse fill="url(#l_5)" stroke="transparent" stroke-width="0" cx="146.12" cy="-88" rx="94.32" ry="18"></ellipse> <text text-anchor="middle" x="146.12" y="-83.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">Critical friend review</text> </g> <!-- c4&#45;&gt;c5 --> <g id="edge4" class="edge">
<title>
c4-&gt;c5
</title>
<path fill="none" stroke="black" d="M146.12,-123.79C146.12,-121.31 146.12,-118.83 146.12,-116.34"></path> <polygon fill="black" stroke="black" points="149.62,-116.14 146.12,-106.14 142.62,-116.14 149.62,-116.14"></polygon> </g> <!-- c6 --> <g id="node7" class="node">
<title>
c6
</title>
<defs> <lineargradient id="l_6" gradientunits="userSpaceOnUse" x1="146.12" y1="-52" x2="146.12" y2="-16"> <stop offset="0" style="stop-color:lightgreen;stop-opacity:1.;"></stop> <stop offset="1" style="stop-color:#8470ff;stop-opacity:1.;"></stop> </lineargradient> </defs> <ellipse fill="url(#l_6)" stroke="transparent" stroke-width="0" cx="146.12" cy="-34" rx="77.05" ry="18"></ellipse> <text text-anchor="middle" x="146.12" y="-29.8" font-family="Helvetica,Arial,sans-serif" font-size="14.00">Customer review</text> </g> <!-- c5&#45;&gt;c6 --> <g id="edge5" class="edge">
<title>
c5-&gt;c6
</title>
<path fill="none" stroke="black" d="M146.12,-69.79C146.12,-67.31 146.12,-64.83 146.12,-62.34"></path> <polygon fill="black" stroke="black" points="149.62,-62.14 146.12,-52.14 142.62,-62.14 149.62,-62.14"></polygon> </g> <!-- c6&#45;&gt;c1 --> <g id="edge6" class="edge">
<title>
c6-&gt;c1
</title>
<path fill="none" stroke="black" d="M69.79,-36.86C48.8,-41.86 28.7,-51.64 17.35,-70 -5.78,-107.43 -5.78,-230.57 17.35,-268 27.13,-283.83 43.41,-293.27 61.16,-298.78"></path> <polygon fill="black" stroke="black" points="60.58,-302.25 71.14,-301.45 62.39,-295.49 60.58,-302.25"></polygon> </g> </g>
</svg>
</p>
</div>
</div>
</div>
<section id="data-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation">Data preparation</h2>
<p>The goal of this step is to end up with one or more base tables on which analysis is then conducted. The base tables should include any data relevant, or possibly relevant, to the initiative. Data preparation may be iterative, as the analysis becomes refined with frequent feedback from stakeholders.</p>
</section>
<section id="analysis-and-modelling" class="level2">
<h2 class="anchored" data-anchor-id="analysis-and-modelling">Analysis and modelling</h2>
<p>In this step we turn data into insights. This could involve a plethora of data science techniques from statistics to machine learning. The choice of which techniques to use will depend on the desired outputs of the initiative and what the data available allows. The problem definition should be used to steer the analysis towards delivery of the agreed outputs.</p>
</section>
<section id="output-artifacts" class="level2">
<h2 class="anchored" data-anchor-id="output-artifacts">Output artifacts</h2>
<p>The expected outputs of an initiative will have been agreed in the problem definition. These will range from written reports, summary slide decks, data sets and applications such as dashboards or interactive reports. Getting frequent feedback is important, as it helps to prevent drift from the problem definition and allows more people to spot problems as early as possible. ?There are general guidelines that apply across most types of output.</p>
</section>
<section id="team-review" class="level2">
<h2 class="anchored" data-anchor-id="team-review">Team review</h2>
<p>Frequent reviews of the work give a chance to pick up on any issues before asking third parties to look at it. An important component of this is code review. With the mindset that the code may become public, put yourself in the shoes of someone coming across the code and wanting to both understand it and then reuse it. This means keeping in mind the principles of <a href="RAP_playbook">Reproducible Analytical Pipelines (RAP)</a>, which benefits others coming across the code in future, but also the team themselves while continuing to work on it.</p>
</section>
<section id="critical-friend-review" class="level2">
<h2 class="anchored" data-anchor-id="critical-friend-review">Critical friend review</h2>
<p>The critical friend is an integral part of the team. They serve as someone to bounce ideas off, offer advice and act as another pair of eyes and ears that may pick up up on something unnoticed by the rest of the team. So keep them in the loop as much as possible by asking them to review things before taking anything to the customer of the initiative.</p>
</section>
<section id="customer-review" class="level2">
<h2 class="anchored" data-anchor-id="customer-review">Customer review</h2>
<p>Before asking the customer to review and feedback on the work, ensure that whichever output they are looking at is either complete according to the problem definition, or for work in progress that you have made it clear what points on the problem definition are (or are not) being covered so far. Use the feedback to help steer things back on course if necessary. Something that can occur is the customer now asking for something different, or entirely new. This should be handled with care, as over-committing can backfire. In such cases it may be better to propose a future phase of work for any additional outputs requested.</p>



</section>

<div class="quarto-listing quarto-listing-container-grid" id="listing-listing">
<div class="list grid quarto-listing-cols-3">
<div class="g-col-1" data-index="0" data-listing-file-modified-sort="1700730932804" data-listing-reading-time-sort="5.235">
<a href="../../guidance/analysis/analysis-steps/01-data-prep.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<p class="card-img-top">
<img src="../../guidance/analysis/analysis-steps/data-prep.jpg" class="thumbnail-image card-img" style="height: 150px;" alt="Photo by Emily Morter on Unsplash">
</p>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
Data preparation
</h5>
<div class="card-text listing-description">
Prepare data and create base table(s)
</div>
<div class="card-attribution card-text-small start">
<div class="listing-author">

</div>
</div>
</div>
</div>
</a>
</div>
<div class="g-col-1" data-index="1" data-listing-file-modified-sort="1700730932805" data-listing-reading-time-sort="2.025">
<a href="../../guidance/analysis/analysis-steps/02-analysis-modelling.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<div class="card-img-bg" style="height: 150px;">
&nbsp;
</div>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
Analysis and modelling
</h5>
<div class="card-text listing-description">
Analyse data and create models to support the expected outputs
</div>
<div class="card-attribution card-text-small start">
<div class="listing-author">

</div>
</div>
</div>
</div>
</a>
</div>
<div class="g-col-1" data-index="2" data-listing-file-modified-sort="1700730932806" data-listing-reading-time-sort="5.655">
<a href="../../guidance/analysis/analysis-steps/03-output_artifacts.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<div class="card-img-bg" style="height: 150px;">
&nbsp;
</div>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
Output artifacts
</h5>
<div class="card-text listing-description">
Draft reports, slide decks, data sets, applications and any other agreed outputs
</div>
<div class="card-attribution card-text-small start">
<div class="listing-author">

</div>
</div>
</div>
</div>
</a>
</div>
<div class="g-col-1" data-index="3" data-listing-file-modified-sort="1700730932807" data-listing-reading-time-sort="3.27">
<a href="../../guidance/analysis/analysis-steps/04-team-review-test.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<div class="card-img-bg" style="height: 150px;">
&nbsp;
</div>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
Team review
</h5>
<div class="card-text listing-description">
Team self-review everything before asking critical friend for feedback
</div>
<div class="card-attribution card-text-small start">
<div class="listing-author">

</div>
</div>
</div>
</div>
</a>
</div>
<div class="g-col-1" data-index="4" data-listing-file-modified-sort="1700730932807" data-listing-reading-time-sort="2.85">
<a href="../../guidance/analysis/analysis-steps/05-critical-friend-review.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<div class="card-img-bg" style="height: 150px;">
&nbsp;
</div>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
Critical friend review
</h5>
<div class="card-text listing-description">
Critical friend reviews in detail and provides feedback
</div>
<div class="card-attribution card-text-small start">
<div class="listing-author">

</div>
</div>
</div>
</div>
</a>
</div>
<div class="g-col-1" data-index="5" data-listing-file-modified-sort="1700730932807" data-listing-reading-time-sort="0.54">
<a href="../../guidance/analysis/analysis-steps/06-customer-review.html" class="quarto-grid-link">
<div class="quarto-grid-item card h-100 card-left">
<div class="card-img-bg" style="height: 150px;">
&nbsp;
</div>
<div class="card-body post-contents">
<h5 class="no-anchor card-title listing-title">
Customer review
</h5>
<div class="card-text listing-description">
Customer reviews and either agrees outputs match expectations or provides detailed feedback to guide the next iteration.
</div>
<div class="card-attribution card-text-small start">
<div class="listing-author">

</div>
</div>
</div>
</div>
</a>
</div>
</div>
<div class="listing-no-matching d-none">
No matching items
</div>
</div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>